# Shell Page Positioning Implementation Summary

## Изменения в content.js

### 1. Добавлена функция позиционирования относительно поиска
```javascript
function positionFloatingContainerRelativeToSearch()
```
- Находит элементы `crt-global-search` и `.creatio-satelite-floating`
- Вычисляет позицию: слева от поиска, по центру по вертикали  
- Обеспечивает отступ 10px между элементами
- Проверяет границы viewport

### 2. Добавлена функция настройки shell-контейнера
```javascript
function setupShellFloatingContainer(buttonWrapper)
```
- Создает floating-контейнер с оптимальными стилями
- Добавляет drag & drop функциональность
- Позиционирует контейнер через 100ms после создания
- Реагирует на изменение размера окна

### 3. Обновлена функция создания меню
- Для shell-страниц используется `setupShellFloatingContainer()`
- Упрощен код и улучшена читаемость

### 4. Улучшен мониторинг кнопок
- Добавлена проверка позиционирования для shell-страниц
- Автоматическое переположение при отклонении >50px
- Мониторинг элемента поиска

### 5. Обновлен MutationObserver
- Отслеживает появление элемента `crt-global-search`
- Автоматически переположивает контейнер при появлении поиска

## Изменения в menu-item-clean.css

### 1. Добавлены стили для shell-страниц
```css
.creatio-satelite-shell
```
- Горизонтальное расположение кнопок
- Фиксированная минимальная ширина 120px
- Центрирование содержимого
- Отсутствие растягивания

### 2. Стили для floating-контейнера
```css
.creatio-satelite-floating
```
- Прозрачный фон
- Минимальные размеры
- Отсутствие границ и теней
- Оптимальные отступы

### 3. Обновлены стили для configuration-страниц
- Добавлены свойства для предотвращения растягивания
- Улучшена совместимость

## Тестовые файлы

### 1. test-shell-search-positioning.html
- Простой тест с элементом поиска
- Кнопки для тестирования позиционирования
- Debug панель с информацией о статусе

### 2. test-shell-positioning-final.html
- Полноценный тест с реалистичной shell-страницей
- Множество тестовых сценариев
- Детальная информация о позиционировании
- Тесты drag & drop функциональности

## Экспортированные функции для тестирования

- `window.positionFloatingContainerRelativeToSearch`
- `window.setupShellFloatingContainer`
- `window.createShellFloatingMenu`

## Ключевые особенности

### ✅ Позиционирование относительно поиска
- Контейнер позиционируется слева от `<crt-global-search/>`
- Вертикальное выравнивание по центру
- Автоматическое переположение при изменениях DOM

### ✅ Минимальный размер контейнера
- `width: auto` - подстраивается под содержимое
- `min-width: auto` - нет принудительного расширения
- Кнопки имеют фиксированную минимальную ширину 120px

### ✅ Адаптивность
- Реагирует на изменение размера окна
- Проверяет границы viewport
- Автоматически корректирует позицию

### ✅ Мониторинг и восстановление
- Проверка позиции каждые 2 секунды
- Автоматическое переположение при отклонении
- Восстановление при удалении элементов

### ✅ Совместимость
- Работает на shell и configuration страницах
- Не появляется на login-страницах
- Сохраняет drag & drop функциональность

## Результат

Теперь на shell-странице контейнер с кнопками Navigation и Actions:
1. **Позиционируется** слева от элемента `<crt-global-search/>` с отступом 10px
2. **Выравнивается** по центру по вертикали относительно поиска
3. **Имеет минимальный размер** - не растягивается больше необходимого
4. **Автоматически переположивается** при изменениях DOM или размера окна
5. **Остается перетаскиваемым** с сохранением всех функций
6. **Полностью прозрачен** без фона, границ и теней
